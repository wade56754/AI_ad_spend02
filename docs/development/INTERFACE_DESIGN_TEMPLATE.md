# 接口设计模板

## 接口基本信息
- **接口名称**: [业务模块] - [具体功能]
- **接口路径**: `/api/v1/{resource}`
- **请求方法**: GET/POST/PUT/DELETE
- **接口描述**: 详细说明接口用途和业务场景
- **优先级**: P0/P1/P2/P3
- **负责人**: [开发者姓名]

## 权限要求
- **角色权限**:
  - ✅ admin - 管理员
  - ✅ manager - 项目经理
  - ✅ data_clerk - 数据员
  - ❌ finance - 财务
  - ❌ media_buyer - 投手

## 请求设计

### 路径参数
| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| id | UUID | 是 | 资源唯一标识 | 550e8400-e29b-41d4-a716-446655440000 |

### 查询参数 (GET)
| 参数名 | 类型 | 必填 | 默认值 | 描述 | 示例 |
|--------|------|------|--------|------|------|
| page | int | 否 | 1 | 页码 | 1 |
| size | int | 否 | 20 | 每页数量 | 20 |
| status | string | 否 | - | 状态过滤 | active |
| search | string | 否 | - | 搜索关键词 | 项目名称 |

### 请求体 (POST/PUT)
```json
{
  "field1": "value1",
  "field2": 123,
  "field3": "2025-11-12",
  "nested_object": {
    "sub_field": "sub_value"
  },
  "array_field": ["item1", "item2"]
}
```

## 响应设计

### 成功响应 (200/201)
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "field1": "value1",
    "field2": 123,
    "created_at": "2025-11-12T10:30:00.000Z"
  },
  "message": "操作成功",
  "code": "SUCCESS",
  "request_id": "550e8400-e29b-41d4-a716-446655440000",
  "timestamp": "2025-11-12T10:30:00.000Z"
}
```

### 分页响应
```json
{
  "success": true,
  "data": {
    "items": [...],
    "pagination": {
      "page": 1,
      "page_size": 20,
      "total": 100,
      "total_pages": 5,
      "has_next": true,
      "has_prev": false
    }
  },
  "message": "获取成功",
  "code": "SUCCESS",
  "request_id": "550e8400-e29b-41d4-a716-446655440000",
  "timestamp": "2025-11-12T10:30:00.000Z"
}
```

### 错误响应
```json
{
  "success": false,
  "data": null,
  "message": "参数验证失败",
  "code": "SYS_VALIDATION_ERROR",
  "request_id": "550e8400-e29b-41d4-a716-446655440000",
  "timestamp": "2025-11-12T10:30:00.000Z",
  "details": {
    "field": "email",
    "reason": "邮箱格式不正确"
  }
}
```

## 业务规则

### 验证规则
1. 字段1: 必填，长度1-50字符
2. 字段2: 可选，必须大于0
3. 字段3: 必填，符合日期格式 YYYY-MM-DD

### 业务逻辑
1. 规则1: 业务逻辑说明
2. 规则2: 状态转换规则
3. 规则3: 权限检查规则

## 错误码
| 错误码 | HTTP状态码 | 说明 | 解决方案 |
|--------|------------|------|----------|
| SYS_VALIDATION_ERROR | 400 | 参数验证失败 | 检查请求参数格式 |
| BIZ_RESOURCE_NOT_FOUND | 404 | 资源不存在 | 检查资源ID是否正确 |
| BIZ_DUPLICATE_RESOURCE | 409 | 资源已存在 | 使用不同的标识符 |

## 测试用例

### 正常场景
1. **场景1**: 完整参数，成功返回
   - 输入: 标准请求参数
   - 预期: 200状态码，正确数据

2. **场景2**: 分页查询，返回分页数据
   - 输入: page=2, size=10
   - 预期: 分页结构正确

### 异常场景
1. **场景3**: 参数验证失败
   - 输入: 缺少必填参数
   - 预期: 400错误，详细错误信息

2. **场景4**: 权限不足
   - 输入: 无权限用户请求
   - 预期: 403错误

## 性能要求
- 响应时间: < 200ms (P95)
- 并发支持: 100 QPS
- 数据量: 支持分页，单页最多100条

## 安全要求
- 必须JWT认证
- 输入参数验证
- SQL注入防护
- XSS防护

## 监控指标
- 接口调用次数
- 平均响应时间
- 错误率
- 用户权限验证失败次数

## 实现注意事项
1. 使用StandardResponse统一响应格式
2. 实现完整的参数验证
3. 添加适当的日志记录
4. 考虑并发场景
5. 实现适当的缓存策略