# æ¥å£å¼€å‘ä»»åŠ¡æµç¨‹æ€»è§ˆ (åŸºäºä¼˜åŒ–æ–‡æ¡£v2.1)

> **é€‚ç”¨åœºæ™¯**: ä½¿ç”¨ClaudeåŠ©æ‰‹è¿›è¡Œå››é˜¶æ®µæ¥å£å¼€å‘
> **å¼€å‘æ¨¡å¼**: è®¾è®¡â†’å®ç°â†’æµ‹è¯•â†’äº¤ä»˜çš„å®Œæ•´å·¥ä½œæµ
> **è´¨é‡ä¿è¯**: æ¯ä¸ªé˜¶æ®µéƒ½æœ‰æ˜ç¡®çš„äº¤ä»˜æ ‡å‡†å’Œæ£€æŸ¥ç‚¹

---

## ğŸ¯ å¼€å‘é˜¶æ®µæ¦‚è§ˆ

### é˜¶æ®µä¸€ï¼šéœ€æ±‚ä¸è®¾è®¡ (2-3å¤©)
**ç›®æ ‡**: å®Œæˆæ¥å£è®¾è®¡å’Œä¸šåŠ¡æµç¨‹å®šä¹‰
**æ ¸å¿ƒäº¤ä»˜**:
- [ ] ä¸šåŠ¡éœ€æ±‚åˆ†æä¸è¾¹ç•Œå®šä¹‰
- [ ] APIç«¯ç‚¹æ¸…å•ï¼ˆæ–¹æ³•/è·¯å¾„/æè¿°/æƒé™/çŠ¶æ€ç ï¼‰
- [ ] è¯·æ±‚/å“åº”Schemaè®¾è®¡ï¼ˆPydantic v2ï¼‰
- [ ] é”™è¯¯ç æ˜ å°„å’Œæƒé™çŸ©é˜µ
- [ ] æ•°æ®æ¨¡å‹è®¾è®¡å’Œç´¢å¼•å»ºè®®

### é˜¶æ®µäºŒï¼šä»£ç å®ç° (3-5å¤©)
**ç›®æ ‡**: å®Œæˆæ¥å£ç¼–ç å’Œä¸šåŠ¡é€»è¾‘å®ç°
**æ ¸å¿ƒäº¤ä»˜**:
- [ ] FastAPIè·¯ç”±éª¨æ¶ï¼ˆä¾èµ–æ³¨å…¥ã€è®¤è¯ã€äº‹åŠ¡ï¼‰
- [ ] Pydanticæ¨¡å‹å®ç°ï¼ˆConfigDicté…ç½®ï¼‰
- [ ] ä¸šåŠ¡é€»è¾‘å±‚å®ç°ï¼ˆServiceå±‚ï¼‰
- [ ] ç»Ÿä¸€å“åº”æ ¼å¼ï¼ˆsuccess_response/error_responseï¼‰
- [ ] å¼‚å¸¸å¤„ç†å’Œå®¡è®¡æ—¥å¿—

### é˜¶æ®µä¸‰ï¼šæµ‹è¯•éªŒè¯ (2-3å¤©)
**ç›®æ ‡**: å®Œæˆæµ‹è¯•è¦†ç›–å’Œè´¨é‡éªŒè¯
**æ ¸å¿ƒäº¤ä»˜**:
- [ ] å•å…ƒæµ‹è¯•ï¼ˆServiceå±‚é€»è¾‘ï¼‰
- [ ] é›†æˆæµ‹è¯•ï¼ˆAPIå¥‘çº¦æµ‹è¯•ï¼‰
- [ ] åˆ†é¡µå’Œé”™è¯¯åœºæ™¯æµ‹è¯•
- [ ] æƒé™æ§åˆ¶æµ‹è¯•çŸ©é˜µ
- [ ] è¦†ç›–ç‡æŠ¥å‘Šï¼ˆâ‰¥70%ï¼‰

### é˜¶æ®µå››ï¼šæ–‡æ¡£ä¸äº¤ä»˜ (1-2å¤©)
**ç›®æ ‡**: å®Œæˆæ–‡æ¡£å’Œéƒ¨ç½²å‡†å¤‡
**æ ¸å¿ƒäº¤ä»˜**:
- [ ] APIæ–‡æ¡£æ›´æ–°ï¼ˆOpenAPIè§„èŒƒï¼‰
- [ ] æ¥å£ä½¿ç”¨ç¤ºä¾‹ï¼ˆREADMEç‰‡æ®µï¼‰
- [ ] éƒ¨ç½²æ£€æŸ¥æ¸…å•
- [ ] æ€§èƒ½åŸºçº¿éªŒè¯
- [ ] å‘å¸ƒå‰æœ€ç»ˆå®¡æŸ¥

---

## ğŸ“‹ è¯¦ç»†ä»»åŠ¡æ¸…å•

### ğŸ” é˜¶æ®µä¸€ï¼šéœ€æ±‚ä¸è®¾è®¡ä»»åŠ¡

#### 1.1 éœ€æ±‚åˆ†æ (0.5å¤©)
- [ ] **ä¸šåŠ¡éœ€æ±‚æ¢³ç†**
  - [ ] æ˜ç¡®æ ¸å¿ƒä¸šåŠ¡åœºæ™¯ï¼ˆå¦‚ï¼šé¡¹ç›®ç®¡ç†ã€è´¦æˆ·åˆ†é…ã€æ—¥æŠ¥æäº¤ï¼‰
  - [ ] è¯†åˆ«å‚ä¸è§’è‰²åŠå…¶æƒé™è¾¹ç•Œï¼ˆadmin/finance/data_operator/account_manager/media_buyerï¼‰
  - [ ] å®šä¹‰æ•°æ®æµå‘å’Œå…³é”®ä¸šåŠ¡è§„åˆ™
  - [ ] è¾“å‡ºï¼šä¸šåŠ¡æµç¨‹å›¾ï¼ˆMermaidæ ¼å¼ï¼‰

- [ ] **æŠ€æœ¯è¾¹ç•Œå®šä¹‰**
  - [ ] ç¡®å®šAPIç‰ˆæœ¬ç­–ç•¥ï¼ˆé»˜è®¤v1ï¼‰
  - [ ] å®šä¹‰èµ„æºå‘½åè§„èŒƒï¼ˆå¤æ•°å½¢å¼ï¼‰
  - [ ] ç¡®å®šè®¤è¯æ–¹å¼ï¼ˆJWT Bearerï¼‰
  - [ ] å®šä¹‰åˆ†é¡µå’Œè¿‡æ»¤å‚æ•°æ ‡å‡†

#### 1.2 æ¥å£è®¾è®¡ (1å¤©)
- [ ] **ç«¯ç‚¹æ¸…å•è®¾è®¡**
  ```markdown
  ## ç«¯ç‚¹è®¾è®¡ç¤ºä¾‹
  | æ–¹æ³• | è·¯å¾„ | æè¿° | æƒé™è¦æ±‚ | å¹‚ç­‰æ€§ | çŠ¶æ€ç  |
  |------|------|------|----------|--------|--------|
  | GET | /api/v1/projects | è·å–é¡¹ç›®åˆ—è¡¨ | admin,manager | æ˜¯ | 200 |
  | POST | /api/v1/projects | åˆ›å»ºæ–°é¡¹ç›® | admin | å¦ | 201 |
  | GET | /api/v1/projects/{id} | è·å–é¡¹ç›®è¯¦æƒ… | admin,manager,client | æ˜¯ | 200 |
  ```

- [ ] **è¯·æ±‚/å“åº”Schemaè®¾è®¡**
  - [ ] ä½¿ç”¨Pydantic v2è¯­æ³•è®¾è®¡æ‰€æœ‰æ¨¡å‹
  - [ ] å®šä¹‰è¯·æ±‚éªŒè¯è§„åˆ™ï¼ˆå­—æ®µçº¦æŸã€è‡ªå®šä¹‰éªŒè¯ï¼‰
  - [ ] è®¾è®¡å“åº”ç»“æ„ï¼ˆæˆåŠŸ/é”™è¯¯/åˆ†é¡µï¼‰
  - [ ] ç¡®ä¿ConfigDict(from_attributes=True)

- [ ] **é”™è¯¯ç è®¾è®¡**
  - [ ] ç³»ç»Ÿçº§é”™è¯¯ç ï¼ˆSYS_xxxæ ¼å¼ï¼‰
  - [ ] ä¸šåŠ¡çº§é”™è¯¯ç ï¼ˆBIZ_xxxæ ¼å¼ï¼‰
  - [ ] å®‰å…¨çº§é”™è¯¯ç ï¼ˆSEC_xxxæ ¼å¼ï¼‰
  - [ ] HTTPçŠ¶æ€ç æ˜ å°„å…³ç³»

#### 1.3 æ•°æ®æ¨¡å‹è®¾è®¡ (0.5å¤©)
- [ ] **æ•°æ®åº“è¡¨è®¾è®¡**
  - [ ] è¡¨ç»“æ„å®šä¹‰ï¼ˆå­—æ®µç±»å‹ã€çº¦æŸã€ç´¢å¼•ï¼‰
  - [ ] RLSç­–ç•¥è®¾è®¡ï¼ˆè¡Œçº§å®‰å…¨ç­–ç•¥ï¼‰
  - [ ] å¤–é”®å…³ç³»å’Œçº§è”è§„åˆ™
  - [ ] å®¡è®¡å­—æ®µè®¾è®¡ï¼ˆcreated_at/updated_atï¼‰

- [ ] **æ€§èƒ½ä¼˜åŒ–è€ƒè™‘**
  - [ ] ç´¢å¼•ç­–ç•¥ï¼ˆæŸ¥è¯¢ä¼˜åŒ–ï¼‰
  - [ ] åˆ†é¡µç­–ç•¥ï¼ˆcursor-based vs offsetï¼‰
  - [ ] ç¼“å­˜ç­–ç•¥ï¼ˆRedisé›†æˆç‚¹ï¼‰

#### 1.4 æƒé™è®¾è®¡ (0.5å¤©)
- [ ] **æƒé™çŸ©é˜µè®¾è®¡**
  ```markdown
  ## æƒé™çŸ©é˜µç¤ºä¾‹
  èµ„æº/æ“ä½œ | admin | finance | data_op | acct_mgr | media_buyer
  -----------|-------|---------|---------|----------|------------
  é¡¹ç›®åˆ—è¡¨   | âœ“     | âœ“       | âœ“       | âœ“        | âœ“
  é¡¹ç›®åˆ›å»º   | âœ“     | âœ—       | âœ—       | âœ—        | âœ—
  è´¢åŠ¡å®¡æ‰¹   | âœ“     | âœ“       | âœ—       | âœ—        | âœ—
  ```

- [ ] **æ•°æ®éš”ç¦»ç­–ç•¥**
  - [ ] åŸºäºè§’è‰²çš„æ•°æ®å¯è§æ€§
  - [ ] RLSç­–ç•¥å®ç°æ–¹æ¡ˆ
  - [ ] ç§Ÿæˆ·éš”ç¦»æœºåˆ¶

#### é˜¶æ®µä¸€äº¤ä»˜æ£€æŸ¥
- [ ] æ¥å£è®¾è®¡æ–‡æ¡£ï¼ˆå«ç«¯ç‚¹æ¸…å•ï¼‰
- [ ] Pydantic Schemaå®šä¹‰è‰æ¡ˆ
- [ ] æ•°æ®åº“ERå›¾å’ŒDDLè„šæœ¬
- [ ] æƒé™çŸ©é˜µå’ŒRLSç­–ç•¥
- [ ] ä¸šåŠ¡æµç¨‹å›¾ï¼ˆMermaidï¼‰

---

### ğŸ’» é˜¶æ®µäºŒï¼šä»£ç å®ç°ä»»åŠ¡

#### 2.1 ç¯å¢ƒå‡†å¤‡ (0.5å¤©)
- [ ] **å¼€å‘ç¯å¢ƒé…ç½®**
  - [ ] Python 3.11+è™šæ‹Ÿç¯å¢ƒ
  - [ ] ä¾èµ–å®‰è£…ï¼š`pip install -r requirements.txt`
  - [ ] ç¯å¢ƒå˜é‡é…ç½®ï¼š`.env`æ–‡ä»¶
  - [ ] æ•°æ®åº“è¿æ¥æµ‹è¯•

- [ ] **ä»£ç ç»“æ„åˆå§‹åŒ–**
  - [ ] åˆ›å»ºæ¨¡å—ç›®å½•ç»“æ„
  - [ ] åˆå§‹åŒ–è·¯ç”±æ–‡ä»¶
  - [ ] åˆ›å»ºSchemaã€Serviceã€æµ‹è¯•æ–‡ä»¶æ¨¡æ¿

#### 2.2 Pydanticæ¨¡å‹å®ç° (1å¤©)
- [ ] **è¯·æ±‚æ¨¡å‹å®ç°**
  ```python
  # é¡¹ç›®åˆ›å»ºè¯·æ±‚æ¨¡å‹ç¤ºä¾‹
  class ProjectCreateRequest(BaseModel):
      model_config = ConfigDict(from_attributes=True)

      name: str = Field(..., min_length=1, max_length=100)
      description: Optional[str] = Field(None, max_length=500)
      client_id: int = Field(..., gt=0)
      budget: Decimal = Field(..., gt=0, decimal_places=2)

      @field_validator('name')
      def validate_name(cls, v):
          if not v.strip():
              raise ValueError('é¡¹ç›®åç§°ä¸èƒ½ä¸ºç©º')
          return v.strip()
  ```

- [ ] **å“åº”æ¨¡å‹å®ç°**
  ```python
  # é¡¹ç›®å“åº”æ¨¡å‹ç¤ºä¾‹
  class ProjectResponse(BaseModel):
      model_config = ConfigDict(from_attributes=True)

      id: int
      name: str
      description: Optional[str]
      client_id: int
      client_name: str
      budget: Decimal
      spent: Decimal
      status: str
      created_at: datetime
      updated_at: datetime
  ```

- [ ] **åˆ†é¡µæ¨¡å‹å®ç°**
  ```python
  class PaginationMeta(BaseModel):
      page: int = Field(ge=1)
      page_size: int = Field(ge=1, le=100)
      total: int = Field(ge=0)
      total_pages: int = Field(ge=0)

  class ProjectListResponse(BaseModel):
      items: List[ProjectResponse]
      meta: PaginationMeta
  ```

#### 2.3 Serviceå±‚å®ç° (1.5å¤©)
- [ ] **åŸºç¡€CRUDæ“ä½œ**
  - [ ] æ•°æ®è®¿é—®å±‚å°è£…
  - [ ] äº‹åŠ¡è¾¹ç•Œç®¡ç†
  - [ ] æ•°æ®éªŒè¯å’Œä¸šåŠ¡è§„åˆ™æ£€æŸ¥
  - [ ] å¼‚å¸¸å¤„ç†å’Œé”™è¯¯ç æ˜ å°„

- [ ] **ä¸šåŠ¡é€»è¾‘å®ç°**
  ```python
  @transaction
  async def create_project(
      self,
      request: ProjectCreateRequest,
      current_user: User
  ) -> Project:
      # ä¸šåŠ¡è§„åˆ™æ£€æŸ¥
      if not await self._can_user_create_project(current_user):
          raise PermissionError("ç”¨æˆ·æ— æƒé™åˆ›å»ºé¡¹ç›®")

      # æ•°æ®åˆ›å»º
      project = Project(
          name=request.name,
          description=request.description,
          client_id=request.client_id,
          budget=request.budget,
          created_by=current_user.id
      )

      self.db.add(project)
      self.db.flush()

      # å®¡è®¡æ—¥å¿—
      await audit_log(
          action="project.created",
          resource_id=project.id,
          user_id=current_user.id
      )

      return project
  ```

#### 2.4 è·¯ç”±å±‚å®ç° (1å¤©)
- [ ] **è·¯ç”±å®šä¹‰å’Œä¾èµ–æ³¨å…¥**
  ```python
  from fastapi import APIRouter, Depends, HTTPException, Query
  from backend.core.dependencies import get_db, require_role
  from backend.core.response import success_response, error_response, paginated_response

  router = APIRouter(prefix="/api/v1/projects", tags=["projects"])

  @router.get(
      "",
      response_model=StandardResponse[ProjectListResponse],
      dependencies=[Depends(require_role(["admin", "manager", "client"]))]
  )
  async def list_projects(
      page: int = Query(1, ge=1),
      page_size: int = Query(20, ge=1, le=100),
      search: Optional[str] = Query(None),
      status: Optional[str] = Query(None),
      db: Session = Depends(get_db),
      current_user: User = Depends(get_current_user)
  ):
  ```

- [ ] **ç»Ÿä¸€å“åº”æ ¼å¼**
  ```python
  @router.post(
      "",
      response_model=StandardResponse[ProjectResponse],
      status_code=201,
      dependencies=[Depends(require_role(["admin"]))]
  )
  async def create_project(
      request: ProjectCreateRequest,
      db: Session = Depends(get_db),
      current_user: User = Depends(get_current_user)
  ):
      try:
          project_service = ProjectService(db)
          project = await project_service.create_project(request, current_user)
          return success_response(
              data=ProjectResponse.model_validate(project),
              message="é¡¹ç›®åˆ›å»ºæˆåŠŸ"
          )
      except PermissionError as e:
          return error_response(
              code="PERMISSION_DENIED",
              message=str(e),
              status_code=403
          )
  ```

#### 2.5 å¼‚å¸¸å¤„ç†å’Œæ—¥å¿— (0.5å¤©)
- [ ] **å…¨å±€å¼‚å¸¸å¤„ç†å™¨**
  ```python
  @app.exception_handler(PermissionError)
  async def permission_exception_handler(request, exc):
      return error_response(
          code="PERMISSION_DENIED",
          message=str(exc),
          status_code=403
      )
  ```

- [ ] **å®¡è®¡æ—¥å¿—å®ç°**
  ```python
  async def audit_log(
      action: str,
      resource_id: int,
      user_id: int,
      details: Optional[Dict] = None
  ):
      audit = AuditLog(
          action=action,
          resource_id=resource_id,
          user_id=user_id,
          details=details or {},
          ip_address=request.client.host
      )
      db.add(audit)
      await db.commit()
  ```

#### é˜¶æ®µäºŒäº¤ä»˜æ£€æŸ¥
- [ ] å®Œæ•´çš„è·¯ç”±å®ç°ï¼ˆå«è®¤è¯å’Œæƒé™ï¼‰
- [ ] Pydanticæ¨¡å‹ï¼ˆè¯·æ±‚/å“åº”/åˆ†é¡µï¼‰
- [ ] Serviceå±‚ä¸šåŠ¡é€»è¾‘
- [ ] ç»Ÿä¸€å“åº”æ ¼å¼åº”ç”¨
- [ ] å¼‚å¸¸å¤„ç†å’Œå®¡è®¡æ—¥å¿—
- [ ] ä»£ç æ ¼å¼åŒ–å’Œé™æ€æ£€æŸ¥é€šè¿‡

---

### ğŸ§ª é˜¶æ®µä¸‰ï¼šæµ‹è¯•éªŒè¯ä»»åŠ¡

#### 3.1 å•å…ƒæµ‹è¯• (1å¤©)
- [ ] **Serviceå±‚æµ‹è¯•**
  ```python
  class TestProjectService:
      async def test_create_project_success(self, db_session):
          service = ProjectService(db_session)
          request = ProjectCreateRequest(
              name="æµ‹è¯•é¡¹ç›®",
              description="æµ‹è¯•æè¿°",
              client_id=1,
              budget=10000.00
          )
          user = User(id=1, role="admin")

          project = await service.create_project(request, user)

          assert project.name == "æµ‹è¯•é¡¹ç›®"
          assert project.created_by == 1
  ```

- [ ] **ä¸šåŠ¡è§„åˆ™æµ‹è¯•**
  - [ ] æƒé™éªŒè¯æµ‹è¯•
  - [ ] æ•°æ®éªŒè¯æµ‹è¯•
  - [ ] è¾¹ç•Œæ¡ä»¶æµ‹è¯•
  - [ ] å¼‚å¸¸åœºæ™¯æµ‹è¯•

#### 3.2 APIé›†æˆæµ‹è¯• (1å¤©)
- [ ] **å¥‘çº¦æµ‹è¯•**
  ```python
  class TestProjectAPI:
      async def test_create_project_api(self, client, auth_headers):
          request_data = {
              "name": "APIæµ‹è¯•é¡¹ç›®",
              "description": "APIæµ‹è¯•æè¿°",
              "client_id": 1,
              "budget": "10000.00"
          }

          response = await client.post(
              "/api/v1/projects",
              json=request_data,
              headers=auth_headers
          )

          assert response.status_code == 201
          data = response.json()
          assert data["success"] is True
          assert data["data"]["name"] == "APIæµ‹è¯•é¡¹ç›®"
  ```

- [ ] **åˆ†é¡µæµ‹è¯•**
  ```python
  async def test_list_projects_pagination(self, client, auth_headers):
      # æµ‹è¯•ç¬¬ä¸€é¡µ
      response = await client.get(
          "/api/v1/projects?page=1&page_size=5",
          headers=auth_headers
      )
      data = response.json()
      assert data["meta"]["pagination"]["page"] == 1
      assert data["meta"]["pagination"]["page_size"] == 5

      # æµ‹è¯•è¶…å‡ºèŒƒå›´
      response = await client.get(
          "/api/v1/projects?page=999&page_size=5",
          headers=auth_headers
      )
      data = response.json()
      assert len(data["data"]["items"]) == 0
  ```

#### 3.3 æƒé™æµ‹è¯• (0.5å¤©)
- [ ] **è§’è‰²æƒé™çŸ©é˜µæµ‹è¯•**
  ```python
  @pytest.mark.parametrize("role,expected_status", [
      ("admin", 201),
      ("finance", 403),
      ("data_operator", 403),
      ("account_manager", 403),
      ("media_buyer", 403)
  ])
  async def test_create_project_permissions(self, client, role, expected_status):
      auth_headers = await get_auth_headers_for_role(role)

      response = await client.post(
          "/api/v1/projects",
          json={...},
          headers=auth_headers
      )

      assert response.status_code == expected_status
  ```

- [ ] **æ•°æ®éš”ç¦»æµ‹è¯•**
  - [ ] ä¸åŒè§’è‰²æ•°æ®å¯è§æ€§æµ‹è¯•
  - [ ] RLSç­–ç•¥æœ‰æ•ˆæ€§æµ‹è¯•
  - [ ] è·¨ç§Ÿæˆ·è®¿é—®é˜»æ­¢æµ‹è¯•

#### 3.4 æ€§èƒ½å’Œå®‰å…¨æµ‹è¯• (0.5å¤©)
- [ ] **æ€§èƒ½åŸºçº¿æµ‹è¯•**
  ```python
  async def test_list_projects_performance(self, client, auth_headers):
      import time

      start_time = time.time()
      response = await client.get(
          "/api/v1/projects?page=1&page_size=20",
          headers=auth_headers
      )
      end_time = time.time()

      assert response.status_code == 200
      assert end_time - start_time < 0.3  # 300mså†…å“åº”
  ```

- [ ] **å®‰å…¨æµ‹è¯•**
  - [ ] SQLæ³¨å…¥é˜²æŠ¤æµ‹è¯•
  - [ ] XSSé˜²æŠ¤æµ‹è¯•
  - [ ] è®¤è¯ç»•è¿‡æµ‹è¯•
  - [ ] æ•æ„Ÿæ•°æ®æ³„éœ²æ£€æŸ¥

#### 3.5 è¦†ç›–ç‡æŠ¥å‘Š (0.5å¤©)
- [ ] **ä»£ç è¦†ç›–ç‡æ”¶é›†**
  ```bash
  pytest --cov=backend.routers.projects \
          --cov=backend.services.project_service \
          --cov-report=term-missing \
          --cov-report=html
  ```

- [ ] **è¦†ç›–ç‡è´¨é‡é—¨ç¦**
  - [ ] æ€»è¦†ç›–ç‡ â‰¥ 70%
  - [ ] æ ¸å¿ƒä¸šåŠ¡é€»è¾‘è¦†ç›–ç‡ = 100%
  - [ ] åˆ†æ”¯è¦†ç›–ç‡ â‰¥ 80%

#### é˜¶æ®µä¸‰äº¤ä»˜æ£€æŸ¥
- [ ] å•å…ƒæµ‹è¯•å¥—ä»¶ï¼ˆâ‰¥70%è¦†ç›–ç‡ï¼‰
- [ ] APIé›†æˆæµ‹è¯•ï¼ˆå«åˆ†é¡µå’Œé”™è¯¯ï¼‰
- [ ] æƒé™æµ‹è¯•çŸ©é˜µ
- [ ] æ€§èƒ½åŸºçº¿æŠ¥å‘Š
- [ ] å®‰å…¨æ‰«ææŠ¥å‘Šï¼ˆbanditã€pip-auditï¼‰

---

### ğŸ“š é˜¶æ®µå››ï¼šæ–‡æ¡£ä¸äº¤ä»˜ä»»åŠ¡

#### 4.1 APIæ–‡æ¡£å®Œå–„ (0.5å¤©)
- [ ] **OpenAPIæ–‡æ¡£å¢å¼º**
  ```python
  @router.post(
      "",
      response_model=StandardResponse[ProjectResponse],
      status_code=201,
      summary="åˆ›å»ºæ–°é¡¹ç›®",
      description="åˆ›å»ºä¸€ä¸ªæ–°çš„å¹¿å‘ŠæŠ•æ”¾é¡¹ç›®ï¼Œéœ€è¦ç®¡ç†å‘˜æƒé™",
      responses={
          201: {"description": "é¡¹ç›®åˆ›å»ºæˆåŠŸ"},
          400: {"description": "è¯·æ±‚å‚æ•°éªŒè¯å¤±è´¥"},
          403: {"description": "æƒé™ä¸è¶³"},
          500: {"description": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯"}
      }
  )
  ```

- [ ] **ç¤ºä¾‹æ–‡æ¡£ç”Ÿæˆ**
  - [ ] è¯·æ±‚ç¤ºä¾‹ï¼ˆcURLã€JavaScriptï¼‰
  - [ ] å“åº”ç¤ºä¾‹ï¼ˆæˆåŠŸã€é”™è¯¯ï¼‰
  - [ ] é”™è¯¯ç è¯´æ˜æ–‡æ¡£

#### 4.2 ä½¿ç”¨æŒ‡å—ç¼–å†™ (0.5å¤©)
- [ ] **READMEæ›´æ–°**
  ```markdown
  ## é¡¹ç›®ç®¡ç†API

  ### è·å–é¡¹ç›®åˆ—è¡¨
  ```bash
  curl -X GET "http://localhost:8000/api/v1/projects?page=1&page_size=20" \
       -H "Authorization: Bearer YOUR_TOKEN"
  ```

  ### åˆ›å»ºæ–°é¡¹ç›®
  ```bash
  curl -X POST "http://localhost:8000/api/v1/projects" \
       -H "Content-Type: application/json" \
       -H "Authorization: Bearer YOUR_TOKEN" \
       -d '{
         "name": "æ–°é¡¹ç›®",
         "description": "é¡¹ç›®æè¿°",
         "client_id": 1,
         "budget": "10000.00"
       }'
  ```
  ```

- [ ] **æœ€ä½³å®è·µæ–‡æ¡£**
  - [ ] é”™è¯¯å¤„ç†æŒ‡å—
  - [ ] åˆ†é¡µä½¿ç”¨å»ºè®®
  - [ ] æƒé™æ£€æŸ¥è¯´æ˜
  - [ ] æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### 4.3 éƒ¨ç½²å‡†å¤‡ (0.5å¤©)
- [ ] **å¥åº·æ£€æŸ¥ç¡®è®¤**
  ```python
  @router.get("/healthz", tags=["health"])
  async def health_check():
      return success_response(
          data={"status": "healthy", "timestamp": datetime.utcnow()},
          message="æœåŠ¡å¥åº·"
      )

  @router.get("/readyz", tags=["health"])
  async def readiness_check(db: Session = Depends(get_db)):
      try:
          db.execute("SELECT 1")
          return success_response(
              data={"status": "ready", "database": "connected"},
              message="æœåŠ¡å°±ç»ª"
          )
      except Exception:
          return error_response(
              code="DATABASE_UNAVAILABLE",
              message="æ•°æ®åº“è¿æ¥å¤±è´¥",
              status_code=503
          )
  ```

- [ ] **Dockeré…ç½®éªŒè¯**
  - [ ] Dockerfileä¼˜åŒ–
  - [ ] å¥åº·æ£€æŸ¥é…ç½®
  - [ ] ç¯å¢ƒå˜é‡æ–‡æ¡£

#### 4.4 æœ€ç»ˆè´¨é‡æ£€æŸ¥ (0.5å¤©)
- [ ] **ä»£ç è´¨é‡é—¨ç¦**
  ```bash
  # ä»£ç æ ¼å¼æ£€æŸ¥
  black --check backend/
  isort --check-only backend/

  # é™æ€åˆ†æ
  flake8 backend/
  mypy backend/

  # å®‰å…¨æ‰«æ
  bandit -r backend/
  pip-audit
  ```

- [ ] **é›†æˆæµ‹è¯•éªŒè¯**
  - [ ] å®Œæ•´ä¸šåŠ¡æµç¨‹æµ‹è¯•
  - [ ] å¤šæœåŠ¡åä½œæµ‹è¯•
  - [ ] æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥

#### é˜¶æ®µå››äº¤ä»˜æ£€æŸ¥
- [ ] å®Œæ•´çš„APIæ–‡æ¡£ï¼ˆOpenAPIï¼‰
- [ ] ä½¿ç”¨ç¤ºä¾‹å’Œæœ€ä½³å®è·µ
- [ ] éƒ¨ç½²é…ç½®å’Œæ£€æŸ¥æ¸…å•
- [ ] è´¨é‡é—¨ç¦æŠ¥å‘Š
- [ ] å‘å¸ƒè¯´æ˜æ–‡æ¡£

---

## ğŸš€ Claudeåä½œå¼€å‘æŒ‡å—

### ä½¿ç”¨Claudeçš„æœ€ä½³å®è·µ

#### 1. é˜¶æ®µå¼€å§‹æ—¶
- **æ˜ç¡®é˜¶æ®µç›®æ ‡**: å‘Šè¯‰Claudeå½“å‰å¤„äºå“ªä¸ªé˜¶æ®µï¼ˆè®¾è®¡/å®ç°/æµ‹è¯•/äº¤ä»˜ï¼‰
- **æä¾›ä¸Šä¸‹æ–‡**: åˆ†äº«ç›¸å…³çš„ä¸šåŠ¡éœ€æ±‚å’ŒæŠ€æœ¯çº¦æŸ
- **è®¾å®šé¢„æœŸç»“æœ**: æ˜ç¡®é˜¶æ®µç»“æŸæ—¶éœ€è¦äº¤ä»˜ä»€ä¹ˆ

#### 2. å¼€å‘è¿‡ç¨‹ä¸­
- **è¿­ä»£å¼€å‘**: æŒ‰ç…§å­ä»»åŠ¡é€ä¸€å®Œæˆï¼ŒåŠæ—¶åé¦ˆé—®é¢˜
- **ä»£ç å®¡æŸ¥**: è®©Claudeæ£€æŸ¥ä»£ç è´¨é‡å’Œè§„èŒƒéµå¾ªæƒ…å†µ
- **æµ‹è¯•é©±åŠ¨**: å…ˆå†™æµ‹è¯•ï¼Œå†å®ç°åŠŸèƒ½ï¼Œç¡®ä¿è´¨é‡

#### 3. é˜¶æ®µç»“æŸæ—¶
- **äº¤ä»˜æ£€æŸ¥**: ä½¿ç”¨æä¾›çš„æ£€æŸ¥æ¸…å•éªŒè¯å®Œæ•´æ€§
- **æ–‡æ¡£åŒæ­¥**: ç¡®ä¿æ–‡æ¡£ä¸ä»£ç å®ç°ä¿æŒä¸€è‡´
- **ä¸‹é˜¶æ®µå‡†å¤‡**: ä¸ºä¸‹ä¸€é˜¶æ®µå‡†å¤‡å¥½å¿…è¦çš„è¾“å…¥

### Claudeæç¤ºè¯æ¨¡æ¿

#### è®¾è®¡é˜¶æ®µæç¤ºè¯
```
æˆ‘æ­£åœ¨å¼€å‘AIå¹¿å‘Šä»£æŠ•ç³»ç»Ÿçš„[æ¨¡å—å]åŠŸèƒ½ï¼Œå½“å‰å¤„äºéœ€æ±‚ä¸è®¾è®¡é˜¶æ®µã€‚

ä¸šåŠ¡èƒŒæ™¯ï¼š[æè¿°ä¸šåŠ¡åœºæ™¯]
æ ¸å¿ƒéœ€æ±‚ï¼š[åˆ—å‡ºä¸»è¦éœ€æ±‚]
æŠ€æœ¯çº¦æŸï¼šFastAPI + Pydantic v2 + PostgreSQL + RLS

è¯·å¸®æˆ‘ï¼š
1. åˆ†æä¸šåŠ¡éœ€æ±‚ï¼Œå®šä¹‰APIç«¯ç‚¹æ¸…å•
2. è®¾è®¡è¯·æ±‚/å“åº”Schemaï¼ˆä½¿ç”¨Pydantic v2ï¼‰
3. å®šä¹‰é”™è¯¯ç å’Œæƒé™çŸ©é˜µ
4. è¾“å‡ºè®¾è®¡æ–‡æ¡£å’Œä¸šåŠ¡æµç¨‹å›¾
```

#### å®ç°é˜¶æ®µæç¤ºè¯
```
æˆ‘æ­£åœ¨å®ç°[æ¨¡å—å]çš„APIæ¥å£ï¼Œå·²æœ‰è®¾è®¡æ–¹æ¡ˆã€‚

è®¾è®¡æ–‡æ¡£ï¼š[é™„ä¸Šè®¾è®¡æ–‡æ¡£é“¾æ¥]
ç«¯ç‚¹æ¸…å•ï¼š[åˆ—å‡ºè¦å®ç°çš„ç«¯ç‚¹]
æ•°æ®åº“æ¨¡å‹ï¼š[æè¿°è¡¨ç»“æ„]

è¯·æŒ‰ç…§ä»¥ä¸‹è¦æ±‚å®ç°ï¼š
1. åˆ›å»ºPydanticæ¨¡å‹ï¼ˆConfigDict(from_attributes=True)ï¼‰
2. å®ç°Serviceå±‚ä¸šåŠ¡é€»è¾‘
3. å®ç°FastAPIè·¯ç”±ï¼ˆå«æƒé™æ§åˆ¶ï¼‰
4. ä½¿ç”¨ç»Ÿä¸€å“åº”æ ¼å¼ï¼ˆsuccess_response/error_responseï¼‰
5. æ·»åŠ å¼‚å¸¸å¤„ç†å’Œå®¡è®¡æ—¥å¿—

æ³¨æ„äº‹é¡¹ï¼š
- ä¸¥æ ¼éµå¾ªé¡¹ç›®ä»£ç è§„èŒƒ
- æ‰€æœ‰æ¥å£éƒ½éœ€è¦JWTè®¤è¯
- å®ç°RLSæ•°æ®éš”ç¦»
- æ·»åŠ é€‚å½“çš„ç±»å‹æ³¨è§£
```

#### æµ‹è¯•é˜¶æ®µæç¤ºè¯
```
æˆ‘éœ€è¦ä¸º[æ¨¡å—å]APIç¼–å†™å®Œæ•´çš„æµ‹è¯•å¥—ä»¶ã€‚

å·²å®ç°æ¥å£ï¼š[åˆ—å‡ºAPIç«¯ç‚¹]
æµ‹è¯•è¦æ±‚ï¼šå•å…ƒæµ‹è¯•+é›†æˆæµ‹è¯•+æƒé™æµ‹è¯•ï¼Œè¦†ç›–ç‡â‰¥70%

è¯·å¸®æˆ‘ï¼š
1. ç¼–å†™Serviceå±‚å•å…ƒæµ‹è¯•
2. ç¼–å†™APIé›†æˆæµ‹è¯•ï¼ˆå«åˆ†é¡µå’Œé”™è¯¯åœºæ™¯ï¼‰
3. ç¼–å†™æƒé™çŸ©é˜µæµ‹è¯•
4. æ€§èƒ½åŸºçº¿æµ‹è¯•
5. ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š

æµ‹è¯•ç¯å¢ƒï¼špytest + TestClient + è¦†ç›–ç‡æ£€æŸ¥
```

#### äº¤ä»˜é˜¶æ®µæç¤ºè¯
```
æˆ‘éœ€è¦å®Œæˆ[æ¨¡å—å]çš„äº¤ä»˜å‡†å¤‡å·¥ä½œã€‚

å·²å®Œæˆï¼šè®¾è®¡â†’å®ç°â†’æµ‹è¯•é˜¶æ®µ
å½“å‰çŠ¶æ€ï¼š[æè¿°å½“å‰çŠ¶æ€]

è¯·å¸®æˆ‘ï¼š
1. å®Œå–„OpenAPIæ–‡æ¡£å’Œç¤ºä¾‹
2. æ›´æ–°READMEä½¿ç”¨æŒ‡å—
3. å‡†å¤‡éƒ¨ç½²é…ç½®å’Œå¥åº·æ£€æŸ¥
4. æ‰§è¡Œæœ€ç»ˆè´¨é‡é—¨ç¦æ£€æŸ¥
5. ç”Ÿæˆå‘å¸ƒè¯´æ˜æ–‡æ¡£

è´¨é‡è¦æ±‚ï¼š
- ä»£ç æ ¼å¼åŒ–æ£€æŸ¥é€šè¿‡
- é™æ€åˆ†ææ— é—®é¢˜
- å®‰å…¨æ‰«æé€šè¿‡
- è¦†ç›–ç‡è¾¾åˆ°è¦æ±‚
```

---

## ğŸ“Š è¿›åº¦è·Ÿè¸ªæ¨¡æ¿

### é˜¶æ®µè¿›åº¦æ£€æŸ¥è¡¨

```
## é¡¹ç›®å¼€å‘è¿›åº¦è·Ÿè¸ª

### é˜¶æ®µä¸€ï¼šéœ€æ±‚ä¸è®¾è®¡ (ç›®æ ‡ï¼š2-3å¤©)
- [x] ä¸šåŠ¡éœ€æ±‚åˆ†æ (0.5å¤©)
- [x] APIç«¯ç‚¹è®¾è®¡ (1å¤©)
- [x] æ•°æ®æ¨¡å‹è®¾è®¡ (0.5å¤©)
- [x] æƒé™çŸ©é˜µè®¾è®¡ (0.5å¤©)
- [x] è®¾è®¡æ–‡æ¡£è¯„å®¡

å®é™…ç”¨æ—¶ï¼š2.5å¤© | è¿›åº¦ï¼š100%

### é˜¶æ®µäºŒï¼šä»£ç å®ç° (ç›®æ ‡ï¼š3-5å¤©)
- [x] ç¯å¢ƒå‡†å¤‡ (0.5å¤©)
- [x] Pydanticæ¨¡å‹ (1å¤©)
- [x] Serviceå±‚å®ç° (1.5å¤©)
- [x] è·¯ç”±å±‚å®ç° (1å¤©)
- [x] å¼‚å¸¸å¤„ç† (0.5å¤©)
- [x] ä»£ç è¯„å®¡

å®é™…ç”¨æ—¶ï¼š4.5å¤© | è¿›åº¦ï¼š100%

### é˜¶æ®µä¸‰ï¼šæµ‹è¯•éªŒè¯ (ç›®æ ‡ï¼š2-3å¤©)
- [x] å•å…ƒæµ‹è¯• (1å¤©)
- [x] APIé›†æˆæµ‹è¯• (1å¤©)
- [x] æƒé™æµ‹è¯• (0.5å¤©)
- [x] æ€§èƒ½å®‰å…¨æµ‹è¯• (0.5å¤©)
- [x] è¦†ç›–ç‡æŠ¥å‘Š (0.5å¤©)

å®é™…ç”¨æ—¶ï¼š3å¤© | è¿›åº¦ï¼š100%

### é˜¶æ®µå››ï¼šæ–‡æ¡£ä¸äº¤ä»˜ (ç›®æ ‡ï¼š1-2å¤©)
- [x] APIæ–‡æ¡£å®Œå–„ (0.5å¤©)
- [x] ä½¿ç”¨æŒ‡å— (0.5å¤©)
- [x] éƒ¨ç½²å‡†å¤‡ (0.5å¤©)
- [x] æœ€ç»ˆæ£€æŸ¥ (0.5å¤©)

å®é™…ç”¨æ—¶ï¼š2å¤© | è¿›åº¦ï¼š100%

## æ€»ä½“è¿›åº¦
é¢„è®¡ç”¨æ—¶ï¼š8-13å¤© | å®é™…ç”¨æ—¶ï¼š12å¤© | æ•ˆç‡ï¼š92%
```

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.1
**åˆ›å»ºæ—¶é—´**: 2025-11-12
**é€‚ç”¨é¡¹ç›®**: AIå¹¿å‘Šä»£æŠ•ç³»ç»Ÿæ¥å£å¼€å‘
**ç»´æŠ¤è´£ä»»äºº**: å¼€å‘å›¢é˜Ÿ
**ä¸‹æ¬¡æ›´æ–°**: é‡å¤§åŠŸèƒ½å˜æ›´æ—¶